<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Ntrial - Signin with your social account</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Custom styles for this template -->
    <link href="http://getbootstrap.com/examples/signin/signin.css" rel="stylesheet">
  </head>

  <body>

    <div class="container">

      <form class="form-signin">
        <h2 class="form-signin-heading">Please sign in</h2>
        
        <a href="#facebook" class="social-login" id="facebook">
          <img src="https://cdn4.iconfinder.com/data/icons/social-media-icons-the-circle-set/48/facebook_circle-64.png">
        </a>
        <a href="#twitter" class="social-login" id="twitter">
          <img src="https://cdn4.iconfinder.com/data/icons/social-media-icons-the-circle-set/48/twitter_circle-64.png">
        </a>
        <a href="#google" class="social-login" id="google" >
          <img src="https://cdn4.iconfinder.com/data/icons/social-media-icons-the-circle-set/48/google_circle-64.png">
        </a>
      </form>

    </div> <!-- /container -->
    
  
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script>

    function postLogin(data, fn){
        $.ajax({
          type: 'post',
          url: '/auth/login',
          data: data,
          dataType: 'json',
          error: function(err){
            fn(err)
          },
          success: function(res){
            fn(null, res)
          }
        })  
      }

    $(function() {
      $('.social-login').each(function(i){

        var type = $(this).attr('id')

        $('#'+type).click(function(){
          postLogin({type: type}, function(err,res){
            if(err) {
              alert('An error occured');
              return;
            }
            window.location.assign(res.login_url)
          })  
        })
        
      })
    })
      
    </script>

  </body>
</html>
